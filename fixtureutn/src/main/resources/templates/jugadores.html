<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/header :: headFrag('Jugadores')"></head>
<body class="bg-light">
<nav th:replace="fragments/header :: nav"></nav>

<div class="container py-4">
    <!-- DEBUG TEMPORAL - para ver qu√© datos llegan -->
    <div class="alert alert-info d-none" th:classappend="${debug} ? 'd-block' : 'd-none'">
        <h6>Debug Info:</h6>
        <div th:each="p : ${players}">
            <span th:text="${p.name}"></span>:
            Photo: <span th:text="${p.photoPath}"></span> |
            Flag: <span th:text="${p.countryFlag}"></span>
        </div>
    </div>

    <div class="row row-cols-2 row-cols-md-4 g-3">
        <div class="col" th:each="p : ${players}">
            <div class="card h-100 text-center shadow-sm">
                <!-- IMAGEN PRINCIPAL CON FALLBACK -->
                <div class="card-img-top d-flex align-items-center justify-content-center"
                     style="height:120px; background-color: #f8f9fa; overflow: hidden;">
                    <img th:if="${p.photoPath != null}"
                         th:src="@{${p.photoPath}}"
                         style="max-height: 100%; max-width: 100%; object-fit: cover;"
                         th:alt="${p.name}"
                         onerror="this.style.display='none'">
                    <div th:if="${p.photoPath == null}" class="text-muted">
                        üì∑ No image
                    </div>
                </div>

                <div class="card-body">
                    <h6 class="card-title mb-0" th:text="${p.name}">Nombre</h6>
                    <small class="text-muted d-block" th:text="${p.position}">Posici√≥n</small>

                    <!-- BANDERA CON FALLBACK -->
                    <div class="mt-2">
                        <img th:if="${p.countryFlag != null}"
                             th:src="@{${p.countryFlag}}"
                             style="height:16px; max-width: 24px; object-fit: contain;"
                             th:alt="'Bandera de ' + ${p.name}"
                             onerror="this.style.display='none'">
                        <span th:if="${p.countryFlag == null}" class="text-muted small">üè¥ Sin bandera</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script th:src="@{https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js}"></script>

<!-- SCRIPT PARA DEBUG EN CONSOLA DEL NAVEGADOR -->
<script>
    console.log("=== DEBUG CLIENTE ===");
    document.querySelectorAll('img').forEach(img => {
        console.log("IMG SRC:", img.src, " - Cargada:", img.complete);
    });
</script>
</body>
</html>